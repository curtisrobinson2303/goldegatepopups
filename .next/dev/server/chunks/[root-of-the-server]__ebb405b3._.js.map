{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 190, "column": 0}, "map": {"version":3,"sources":["file:///Users/curtisrobinson/goldegatepopups/app/api/signup/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { google } from 'googleapis';\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { phone, name } = await request.json();\n\n    // Validate input\n    if (!phone) {\n      return NextResponse.json(\n        { error: 'Phone number is required' },\n        { status: 400 }\n      );\n    }\n\n    const timestamp = new Date().toISOString();\n    \n    // Log to console (always useful for debugging)\n    console.log('New signup:', { phone, name: name || 'Not provided', timestamp });\n\n    // Save to Google Sheets if configured\n    if (process.env.GOOGLE_SHEETS_ID && process.env.GOOGLE_SERVICE_ACCOUNT_EMAIL && process.env.GOOGLE_PRIVATE_KEY) {\n      try {\n        const auth = new google.auth.JWT(\n          process.env.GOOGLE_SERVICE_ACCOUNT_EMAIL,\n          undefined,\n          process.env.GOOGLE_PRIVATE_KEY?.replace(/\\\\n/g, '\\n'),\n          ['https://www.googleapis.com/auth/spreadsheets']\n        );\n\n        const sheets = google.sheets({ version: 'v4', auth });\n        \n        // Append row to the spreadsheet\n        await sheets.spreadsheets.values.append({\n          spreadsheetId: process.env.GOOGLE_SHEETS_ID,\n          range: 'Sheet1!A:C', // Adjust range as needed\n          valueInputOption: 'USER_ENTERED',\n          requestBody: {\n            values: [[timestamp, phone, name || '']],\n          },\n        });\n\n        console.log('Saved to Google Sheets successfully');\n      } catch (sheetsError) {\n        // Log error but don't fail the request\n        console.error('Google Sheets error:', sheetsError);\n      }\n    }\n\n    return NextResponse.json(\n      { \n        success: true, \n        message: 'Successfully signed up!',\n      },\n      { status: 200 }\n    );\n  } catch (error) {\n    console.error('Signup error:', error);\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE1C,iBAAiB;QACjB,IAAI,CAAC,OAAO;YACV,OAAO,mKAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA2B,GACpC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,YAAY,IAAI,OAAO,WAAW;QAExC,+CAA+C;QAC/C,QAAQ,GAAG,CAAC,eAAe;YAAE;YAAO,MAAM,QAAQ;YAAgB;QAAU;QAE5E,sCAAsC;QACtC,IAAI,QAAQ,GAAG,CAAC,gBAAgB,IAAI,QAAQ,GAAG,CAAC,4BAA4B,IAAI,QAAQ,GAAG,CAAC,kBAAkB,EAAE;YAC9G,IAAI;gBACF,MAAM,OAAO,IAAI,kLAAM,CAAC,IAAI,CAAC,GAAG,CAC9B,QAAQ,GAAG,CAAC,4BAA4B,EACxC,WACA,QAAQ,GAAG,CAAC,kBAAkB,EAAE,QAAQ,QAAQ,OAChD;oBAAC;iBAA+C;gBAGlD,MAAM,SAAS,kLAAM,CAAC,MAAM,CAAC;oBAAE,SAAS;oBAAM;gBAAK;gBAEnD,gCAAgC;gBAChC,MAAM,OAAO,YAAY,CAAC,MAAM,CAAC,MAAM,CAAC;oBACtC,eAAe,QAAQ,GAAG,CAAC,gBAAgB;oBAC3C,OAAO;oBACP,kBAAkB;oBAClB,aAAa;wBACX,QAAQ;4BAAC;gCAAC;gCAAW;gCAAO,QAAQ;6BAAG;yBAAC;oBAC1C;gBACF;gBAEA,QAAQ,GAAG,CAAC;YACd,EAAE,OAAO,aAAa;gBACpB,uCAAuC;gBACvC,QAAQ,KAAK,CAAC,wBAAwB;YACxC;QACF;QAEA,OAAO,mKAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,SAAS;QACX,GACA;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO,mKAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}